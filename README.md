# Derin_Ogrenme_Yontemleri_ile_X-Ray_Goruntulerinde_Tehlikeli_Nesnelerin_Hizli_ve_Guvenilir-Tespiti
1. Proje Özeti (Project Overview)
  Bu çalışma, havaalanı, sınır kapısı ve alışveriş merkezleri gibi kritik alanlarda güvenliği artırmak amacıyla X-Ray görüntülerinde tehlikeli nesnelerin hızlı ve güvenilir şekilde tespitini hedeflemektedir. YOLOv8 mimarisi kullanılarak iki aşamalı bir eğitim stratejisi izlenmiş; ilk aşamada Sixray veri setiyle ön eğitim yapılmış, ikinci aşamada ise X-Ray Baggage Detection veri setiyle fine-tuning uygulanmıştır. Modelin performansı precision, recall, mAP ve F1-Skoru gibi metriklerle değerlendirilmiş, iki veri seti arasında ciddi başarı farkı gözlenmiş ve bunun sebebinin felaket unutma (catastrophic forgetting) olduğu belirlenmiştir. Grad-CAM tabanlı açıklanabilir yapay zekâ entegrasyonu ile modelin karar süreçleri şeffaflaştırılmış, böylece mevcut güvenlik yöntemlerine kıyasla daha yüksek doğruluk, hız ve güvenilirlik sağlanarak toplumsal güvenlik ve sürdürülebilir şehir vizyonuna katkı sunulmuştur.

2. Veri Setleri (Dataset)
Projede iki farklı veri seti kullanılmıştır.

    2.1. Sixray Veri Seti (https://universe.roboflow.com/siewchinyip-outlook-my/sixray/dataset/4/images?split=valid)
   Bu veri seti 8312 adet X-ray görüntüsünden oluşmaktadır. Veri setindeki tehlikeli nesneler sınır kutularıyla belirtilmiş olup YOLOv8 formatında etiketlenmiştir. Tehlikeli nesneler beş sınıfta sınıflandırılmıştır. Bunlar: 1-Silah, 2-Bıçak, 3-Pense, 4-Makas, 5-İngiliz Anahtarı'dır. Bu veri seti 70:20:10 oranlarında ayrılmıştır.

   2.2.X-Ray Baggage Detection Veri Seti (https://universe.roboflow.com/malek-mhnrl/x-ray-baggage-detection/dataset/1)
   Bu veri seti 8830 adet X-ray görüntüsünden oluşmaktadır. Önceki veri setindeki gibi bu veri setindeki tehlikeli nesneler de sınır kutusuyla belirtilmiş olup YOLOv8 tabanında etiketlenmiştir. Önceki veri setinden farklı sınıflandırılmıştır. Bu yüzden iki veri seti birleştirilip tek bir veri seti şeklinde eğitilmek yerine iki aşamalı bir eğitim stratejisi benimsenmiştir. Bu veri seti de 70:20:10 oranlarında parçalanıp fine-tune aşamasında kullanılmıştır.

3. Yöntem (Methodology)
    Çalışmada kullanılan iki X-ray veri setinin sınıf tanımları birebir örtüşmediği için, veri setlerinin doğrudan birleştirilerek tek aşamalı bir eğitim sürecine sokulması uygun görülmemiştir. Böyle bir yaklaşım, modelin sınıf öğrenme sürecinde karışıklığa yol açabilecek ve etiket uyumsuzluğu nedeniyle öğrenme performansını olumsuz etkileyebilecekti. Bu nedenle, bu çalışmada bilinçli bir şekilde iki aşamalı bir eğitim stratejisi benimsenmiştir. 
    İlk aşamada, Sixray veri seti kullanılarak model eğitilmiştir. Sixray veri seti, X-ray görüntülerde farklı türde tehlikeli nesneleri içeren ve nispeten geniş bir veri hacmine sahip bir veri setidir. Bu aşamanın temel amacı, modelin belirli nesne sınıflarını ezberlemesi değil; X-ray görüntülere özgü genel görsel örüntüleri öğrenmesini sağlamaktır. Bu kapsamda model, metal yoğunluklarının dağılımını, sert ve sivri yapıların görsel özelliklerini, X-ray görüntülerde nesnelerin arka planla olan kontrast ilişkilerini ve tehlikeli nesnelere özgü genel siluetleri öğrenmiştir. İkinci aşamada ise, Sixray veri seti ile eğitilmiş model ağırlıkları başlangıç noktası olarak alınmış ve model, X-ray baggage detection veri seti üzerinde fine-tuning(ince ayar) işlemine tabi tutulmuştur. Fine-tuning süreci, modelin daha önce öğrendiği genel X-ray temsillerini koruyarak, bu temsilleri hedef problem alanına özgü sınıf yapısına uyarlamayı amaçlamaktadır. Bu aşamada modelin ağırlıkları sıfırdan başlatılmamış; önceki aşamada öğrenilen bilgiler korunarak, modelin yeni veri setine daha hızlı ve kararlı bir şekilde adapte olması sağlanmıştır. Böylece model, X-ray görüntülerin genel karakterini zaten bildiği için, hedef veri setinde yer alan yasaklı nesneleri daha etkin biçimde öğrenebilmiştir. İki veri setinin sınıf yapılarının farklı olması nedeniyle, Sixray veri setindeki sınıflar ile X-ray baggage detection veri setindeki sınıflar arasında doğrudan bir eşleme yapılmamıştır. Bunun yerine, fine-tuning sürecinde modelin sınıflandırma başlığı hedef veri setine uygun şekilde yeniden öğrenilmiştir. Bu yaklaşım, modelin eski sınıf bilgilerini zorla taşımaya çalışmasını engellemiş ve olası sınıf karmaşasının önüne geçmiştir. Bu sayede model, önce genel X-ray görsel özelliklerini öğrenmiş, ardından bu bilgileri hedef veri setine özgü sınıflar bağlamında yeniden yapılandırmıştır. Eğitim ve fine-tuning süreçleri boyunca YOLOv8 mimarisinin kendi veri yükleme ve ön işleme mekanizmaları kullanılmıştır. Görüntüler belirlenen giriş boyutuna ölçeklendirilmiş, bounding box etiketleri YOLO formatında modele sunulmuş ve model kayıp fonksiyonları üzerinden ağırlıklarını optimize etmiştir. Eğitim sürecinde elde edilen ağırlıklar düzenli olarak kaydedilmiş; doğrulama verisi üzerinde en iyi performansı gösteren ağırlıklar “en iyi model” olarak seçilmiştir. Eğitim sürecinin yarıda kesildiği durumlarda, son kaydedilen ağırlıklar üzerinden eğitime devam edilerek süreç tamamlanmıştır.
   Modelin karar verme sürecinin anlaşılabilir ve yorumlanabilir hale getirilmesi de hedeflenmiştir. Bu doğrultuda, eğitilmiş modele Grad-CAM tabanlı Açıklanabilir Yapay Zekâ (XAI) yöntemi entegre edilmiştir. Grad-CAM yöntemi, modelin son konvolüsyon katmanlarındaki aktivasyonlar ile bu aktivasyonlara ait gradyanları kullanarak, modelin bir tahmin üretirken görüntünün hangi bölgelerine odaklandığını ısı haritaları şeklinde görselleştirmektedir. Çalışmada, XAI çıktılarının daha anlamlı hale getirilebilmesi için, ısı haritaları hem tüm görüntü üzerinde hem de bounding box odaklı kırpımlar üzerinde üretilmiştir.
4.Performans Sonuçları
  İki aşamalı eğitilen model, her iki veri setinin test kümesindeki verilerde test edildiğinde her iki veri setinin başarıları arasında ciddi farklar olduğu gözlenmiştir.
                            ____________________________ 
                 __________|      VERİ SETLERİ          | 
                |  METRİK  |  sixray | baggage detection|
                |---------------------------------------|
                | precision| 0.0136  |      0.8570      |
                |    recall| 0.0011  |      0.8039      |
                |     mAP50| 0.0070  |      0.8673      |
                |  mAP50-95| 0.0019  |      0.4445      |
                |  F1-Score| 0.0021  |      0.8250      |
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   Bu veri setleri arasında bu kadar perfomans farklılıklarının gözlenmesi modelin “Felaket Unutma (Catastrophic Forgetting)” yaşadığını kanıtlamaktadır. Model eğitimine Sixray veri setiyle başlayıp ardından X-Ray Baggage Detection veri setiyle finetune uygulandığı için model Felaket Unutma yaşamıştır. X-Ray Baggage Detection veri setinde model başarısı yüksek olup Sixray’de düşmesinin sebebi budur. 
